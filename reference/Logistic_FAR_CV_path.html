<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Cross-validation for solution path of Logistic FAR. — Logistic_FAR_CV_path • LogisticFAR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cross-validation for solution path of Logistic FAR. — Logistic_FAR_CV_path"><meta name="description" content="Logistic_FAR_CV_path finds the solution path of logistic functional
additive regression with log-contrast constrain via Logistic_FAR_Path.
And it will use cross-validation to assess the goodness of the estimations
in the solution path."><meta property="og:description" content="Logistic_FAR_CV_path finds the solution path of logistic functional
additive regression with log-contrast constrain via Logistic_FAR_Path.
And it will use cross-validation to assess the goodness of the estimations
in the solution path."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">LogisticFAR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9013</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Oracle_Estimator.html">Oracle Estimator</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fenguoerbian/LogisticFAR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Cross-validation for solution path of Logistic FAR.</h1>
      <small class="dont-index">Source: <a href="https://github.com/fenguoerbian/LogisticFAR/blob/master/R/path_solver.R" class="external-link"><code>R/path_solver.R</code></a></small>
      <div class="d-none name"><code>Logistic_FAR_CV_path.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>Logistic_FAR_CV_path</code> finds the solution path of logistic functional
additive regression with log-contrast constrain via <code>Logistic_FAR_Path</code>.
And it will use cross-validation to assess the goodness of the estimations
in the solution path.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Logistic_FAR_CV_path</span><span class="op">(</span></span>
<span>  <span class="va">y_vec</span>,</span>
<span>  <span class="va">x_mat</span>,</span>
<span>  <span class="va">h</span>,</span>
<span>  <span class="va">kn</span>,</span>
<span>  <span class="va">p</span>,</span>
<span>  <span class="va">p_type</span>,</span>
<span>  <span class="va">p_param</span>,</span>
<span>  <span class="va">lambda_seq</span>,</span>
<span>  <span class="va">lambda_length</span>,</span>
<span>  min_lambda_ratio <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  <span class="va">mu2</span>,</span>
<span>  a <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bj_vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">kn</span><span class="op">)</span>, <span class="va">p</span><span class="op">)</span>,</span>
<span>  cj_vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span>,</span>
<span>  rj_vec <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  weight_vec <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  logit_weight_vec <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weight_already_combine <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">relax_vec</span>,</span>
<span>  <span class="va">delta_init</span>,</span>
<span>  <span class="va">eta_stack_init</span>,</span>
<span>  <span class="va">mu_1_init</span>,</span>
<span>  <span class="va">tol</span>,</span>
<span>  <span class="va">max_iter</span>,</span>
<span>  nfold <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  <span class="va">fold_seed</span>,</span>
<span>  post_selection <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  post_a <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y-vec">y_vec<a class="anchor" aria-label="anchor" href="#arg-y-vec"></a></dt>
<dd><p>response vector, 0 for control, 1 for case.
n = length(y_vec) is the number of observations.</p></dd>


<dt id="arg-x-mat">x_mat<a class="anchor" aria-label="anchor" href="#arg-x-mat"></a></dt>
<dd><p>covariate matrix, consists of two parts.
dim(x_mat) = (n, h + p * kn)
First h columns are for demographical covariates(can include an intercept term)
Rest columns are for p functional covariates, each being represented by a set of basis functions resulting kn covariates.</p></dd>


<dt id="arg-h-kn-p">h, kn, p<a class="anchor" aria-label="anchor" href="#arg-h-kn-p"></a></dt>
<dd><p>dimension information for the dataset(<code>x_mat</code>).</p></dd>


<dt id="arg-p-type">p_type<a class="anchor" aria-label="anchor" href="#arg-p-type"></a></dt>
<dd><p>an character variable indicating different types of the penalty</p></dd>


<dt id="arg-p-param">p_param<a class="anchor" aria-label="anchor" href="#arg-p-param"></a></dt>
<dd><p>numerical vector for the penalty function.
<code>p_param[1]</code> store sthe lambda value and will be provided by <code>lambda_seq</code>.</p></dd>


<dt id="arg-lambda-seq">lambda_seq<a class="anchor" aria-label="anchor" href="#arg-lambda-seq"></a></dt>
<dd><p>a non-negative sequence of lambda, along which the solution path is searched.
It is RECOMMENED to not supply this parameter and let the function itself determines
it from the given data.</p></dd>


<dt id="arg-lambda-length">lambda_length<a class="anchor" aria-label="anchor" href="#arg-lambda-length"></a></dt>
<dd><p>length of the lambda sequence when computing <code>lambda_seq</code>.
If <code>lambda_seq</code> is provided, then of course <code>lambda_length = length(lambda_seq)</code>.</p></dd>


<dt id="arg-mu-">mu2<a class="anchor" aria-label="anchor" href="#arg-mu-"></a></dt>
<dd><p>quadratic term in the ADMM algorithm</p></dd>


<dt id="arg-a-bj-vec-cj-vec-rj-vec">a, bj_vec, cj_vec, rj_vec<a class="anchor" aria-label="anchor" href="#arg-a-bj-vec-cj-vec-rj-vec"></a></dt>
<dd><p>parameters for the algorithm. See Algorithm_Details.pdf
for more information.</p></dd>


<dt id="arg-weight-vec">weight_vec<a class="anchor" aria-label="anchor" href="#arg-weight-vec"></a></dt>
<dd><p>weight vector for each subject.
The final weight for each subject will be adjusted also by <code>logit_weight_vec</code>.
And the summation of the final weight vector is normalized to <code>n</code>, the sample size.</p></dd>


<dt id="arg-logit-weight-vec">logit_weight_vec<a class="anchor" aria-label="anchor" href="#arg-logit-weight-vec"></a></dt>
<dd><p>weight vector for each subject when computing the integral in the logit values.
Each entry should be positive and no more than 1.
This is a naive method for adjusting for early stop during the interval.</p></dd>


<dt id="arg-weight-already-combine">weight_already_combine<a class="anchor" aria-label="anchor" href="#arg-weight-already-combine"></a></dt>
<dd><p>boolen, indicating whether the <code>weight_vec</code>
is already combined with <code>logit_weight_vec</code> for each subject.</p></dd>


<dt id="arg-relax-vec">relax_vec<a class="anchor" aria-label="anchor" href="#arg-relax-vec"></a></dt>
<dd><p>not used.</p></dd>


<dt id="arg-delta-init-eta-stack-init-mu-init">delta_init, eta_stack_init, mu1_init<a class="anchor" aria-label="anchor" href="#arg-delta-init-eta-stack-init-mu-init"></a></dt>
<dd><p>initial values for the algorithm.</p></dd>


<dt id="arg-tol-max-iter">tol, max_iter<a class="anchor" aria-label="anchor" href="#arg-tol-max-iter"></a></dt>
<dd><p>convergence tolerance and max number of iteration of the algorithm.</p></dd>


<dt id="arg-nfold">nfold<a class="anchor" aria-label="anchor" href="#arg-nfold"></a></dt>
<dd><p>integer, number of folds</p></dd>


<dt id="arg-fold-seed">fold_seed<a class="anchor" aria-label="anchor" href="#arg-fold-seed"></a></dt>
<dd><p>if supplied, use this seed to generate the partitions for cross-validation.
Can be useful for reproducible runs.</p></dd>


<dt id="arg-post-selection">post_selection<a class="anchor" aria-label="anchor" href="#arg-post-selection"></a></dt>
<dd><p>bool, should the function also computes cross-validation results
based on post selection estimation results.</p></dd>


<dt id="arg-post-a">post_a<a class="anchor" aria-label="anchor" href="#arg-post-a"></a></dt>
<dd><p><code>a</code> for the post selection estimation.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>integer, indicating level of information to be printed during computation, currently supports:
always: some info if something went wrong, e.g. when no penalty function is matched
1: information about the start and stop of the iteration
2. How the loss value is changed during each iteration</p></dd>


<dt id="arg-min-lam-ratio-">min_lam_ratio:<a class="anchor" aria-label="anchor" href="#arg-min-lam-ratio-"></a></dt>
<dd><p><code>min(lambda_seq) / max{lambda_seq}</code>. This function uses this
parameter to determine the minimal value of <code>lambda_seq</code>. If <code>p &gt; n</code>, then it
is recommended to set this no smaller than 0.01 (sometimes even 0.05), otherwise you can
set it to 0.001 or even smaller.</p></dd>


<dt id="arg-svd-thresh">svd_thresh<a class="anchor" aria-label="anchor" href="#arg-svd-thresh"></a></dt>
<dd><p>not used.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the solution path of <code>delta</code>, <code>eta_stack</code>, <code>mu1</code>
and some computation information such as convergency, iteration number and the lambda
sequence of this solution path. Also information of CV is returned such as the fold ID
for each observation, the loglikelihood results on each test set and the index with the
highest average loglik on the testsets. If <code>post_selection = TRUE</code>, same results
based on the post selection estimation are also returned.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Although this function will return the index of lambda given the highest
averaged loglik on the testsets. It is more recommended to use the stand alone
<code>*_pick</code> functions in this packages, such as <code>CV_Pick</code> to find a optimal
lambda since those functions give more flexibility.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Chao Cheng.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

